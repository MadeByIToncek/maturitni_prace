\documentclass[12pt,a4paper,titlepage]{article}
\usepackage[utf8]{inputenc}
\usepackage{csquotes}
\usepackage[T1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage[left=3cm,right=3cm,top=2.5cm,bottom=2.5cm]{geometry}
\usepackage[dvipsnames]{xcolor}
\usepackage[czech]{babel}
\usepackage[
  backend=biber,
  style=iso-numeric,
  maxbibnames=99
]{biblatex}
\addbibresource{maturitni_prace.bib}
\usepackage{graphicx}
\usepackage{minted}
\usepackage{subcaption} %  for subfigures environments 
%% Some packages you will need
\usepackage{tikz}
\usepackage{pgfplots}
\graphicspath{ {./images/} }

\usepackage{setspace}
\fontfamily{ptm}
\usepackage{tabularx,ragged2e,booktabs}
\usepackage{hyperref}

\DeclareBibliographyCategory{skipbibliography}
\DeclareCiteCommand{\fcite}[\mkbibfootnote]
  {\usebibmacro{prenote}}
  {\addtocategory{skipbibliography}{\thefield{entrykey}}%
   \usedriver{\DeclareNameAlias{sortname}{default}}{\thefield{entrytype}}}
  {\multicitedelim}
  {\usebibmacro{postnote}}

\author{Antonín Vřešťál}
\title{Tvorba astronomických videí}
\renewcommand{\baselinestretch}{1.5} 


\begin{document}
\begin{titlepage}
	\begin{center}
		Waldorfská základní a střední škola Semily, p.\  o.\\
		Tyršova 485, 513 01 Semily
		\vspace*{1cm}
 
		\vfill		

		\Huge
		Tvorba astronomických videí
 
		\normalsize
		\vspace{0.5cm}
		Maturitní práce 	 
		 
		\vfill		
	\end{center}
	Vypracoval: Antonín Vřešťál\\
	Vedoucí práce: MgA. Mojmír Dlabola\\
	\textcolor{red}{Pracovní verze}\\
 \end{titlepage}
\newpage
\section*{Prohlášení}
Prohlašuji, že jsem tuto projektovou maturitní práci \enquote{Tvorba astronomických videí} napsal samostatně a výhradně s použitím citovaných pramenů. Souhlasím, aby má projektová maturitní práce byla zpřístupněna veřejnosti ke studijním účelům.
\section*{Poděkování}
Děkuji MgA. Mojmíru Dlabolovi, vedoucímu mé práce, za podnětné připomínky k projektové maturitní práci po stránce obsahové i stylistické a za doporučení vhodné a zajímavé literatury. Velmi si vážím času, který věnoval vedení mé práce.\\
\\
V Semilech dne \hspace{0.05cm} \rule[-3pt]{1.5in}{0.5pt}\\
\\
\hspace{0.5cm} \rule[-3pt]{5.5cm}{0.5pt}\\
\indent \indent Antonín Vřešťál\\

\newpage
\tableofcontents
\newpage
\part{Teoretická část}
\textcolor{red}{Odstavce na začátku odstavců}
\textcolor{red}{Multimédia do textu}
\section{Úvod}
%\textcolor{red}{(Nejsem si úplně jistý, jak by měla tato sekce vypadat, budu rád za Váš názor.)}
Tvorbou astronomických videí se zabývám více než tři roky, a to jako editor ve skupině AstroCrew. Skupinu AstroCrew tvoří tři členové:

\textcolor{red}{Změnit na odrážky}
\begin{enumerate}
	\item Daniel Kurtin píše scénáře,
	\item Terka Toušová načítá text na mikrofon
	\item Já (Antonín Vřešťál) k nahrávkám následně tvořím grafický podklad a kompletuji veškerá data do výsledného videa.
\end{enumerate}
Hotová videa následně publikujeme na našem YouTube kanálu. 

Základním cílem skupiny AstroCrew je zpřístupnit široké veřejnosti zajímavé úkazy na obloze pomocí animací a videí. Diváci mají poté lepší přehled o umístění jednotlivých úkazů na noční obloze a mohou je následně lépe nalézt.

Spolupracujeme s planetáriem v liberecké iQLandii. Na jejich akcích \enquote{Večery pod hvězdami} jsou naše nová videa promítána přímo v planetáriu jako součást oficiálního programu. Kromě videí o astronomii zpřístupňujeme široké veřejnosti i kosmonautiku. V tomto odvětví se věnujeme primárně živým přenosům startů raket, poslední dobou nejvíce programu Starship.

Téma tvorby astronomických videí jsem si vybral zejména kvůli jeho obsáhlosti. V rámci produkce videí ve skupině AstroCrew programuji animační nástroje, ale následně pomocí nich animuji scénu a výsledná data nakonec kompletuji ve finální video. V této maturitní práci se zaměřuji zejména na moji část produkce videa. Ostatní části tvorby videa, které nezpracovávám já, jsou zastoupeny pouze stručně obsahově pro doplnění kontextu. 
\section{Postup vytváření videa}\label{makingof}
\subsection{Příprava textových a zvukových podkladů}\label{makingof:text-audio-prep}
Téma připravovaného videa je většinou rozhodnuto s dostatečným předstihem na základě společném diskuze. Každé video je unikátní s ohledem na námi zvolené požadavky. Tyto požadavky vybíráme na základě chyb, nedostatků a nových zjištění nabytých při tvorbě předchozích videí. V případě videa, týkajícího se úkazů na noční obloze v roce 2025, byla hlavním tématem diskuze o jeho délce s ohledem na rozhodnutí, které úkazy do videa budou zahrnuty a které bude nutno vynechat.

Dalším krokem v produkci videa je sepsání scénáře naším scénáristou Danem Kurtinem. 

Po dokončení scénáře jde na řadu samotné nahrávání audiostopy. Proces nahrávání je odlišný pro každý samostatný projekt. Pro obě videa, řešená touto projektovou maturitní prací, byl proces tvorby zvuku víceméně shodný, až na malé detaily. 

\textcolor{red}{Zeptat se terky na popis studia doma i v Praze}

Terka standardně nahrává audiostopy v domácím nahrávacím studiu. Tentokrát byla nucena z časových důvodů nahrávat audiostopu na mobilní telefon na kolejích v Praze. Kombinace těchto faktorů způsobila, že prosincové video obsahuje výrazný šum na pozadí nahrávky, který není možné úplně odstranit. Tento problém se nám podařilo vyřešit v následujícím videu pomocí \enquote{peřinového bunkru}, který značnou část šumu na pozadí odfiltroval. I bez speciálních zvukových panelů, které jsou pro tento účel instalovány ve studiích, se nám podařilo výrazně zvýšit kvalitu zvukové stopy. Porovnání šumu na zvukových stopách je znázorněno frekvenční analýzou na obrázku~\ref{img:fourier}.
\subsection{Animování oblohy v programu Stellárium}\label{makingof:stellarium}
Celý proces animování začíná prací se scénářem. Ze scénáře se vypíše seznam jednotlivých scén a přechodů mezi nimi. Pro tento úkol jsem si vytvořil speciální formát zápisu, který obsahuje vše, co je potřebné k vytvoření jednotlivých přechodů ve videu. Viz tabulka~\ref{tab:scenar}.

Většina animací, které se v těchto videích nachází, byly vytvořeny pomocí simulačního programu Stellarium. Tento program je open-source (jeho zdrojový kód je volně dostupný) a jeho primárním účelem je realistická simulace noční oblohy při pohledu očima nebo dalekohledem\fcite{stellarium:homepage}. Stellarium poskytuje širokou nabídku programovatelných rozhraní. Pro účely této práce využívám webový server, přes který lze instanci Stellaria ovládat z prohlížeče a skriptovací rozhraní, které umožňuje interakci se Stellariem pomocí programovacího jazyka, založeného na standardu ECMAScript (využívaného například jazykem JavaScript\fcite{wiki:ecmascript}).

Největším problémem pro využití Stellaria v produkci videí je fakt, že jeho tvůrci nepočítali s jeho využitím pro tvorbu videí. Neexistuje tam například funkce, která by Stellariu řekla \enquote{Otoč se plynule na tyto souřadnice a přitom nahraj video}. Jedinou možností, jak získat tuto animaci, je export každého samostatného snímku jako separátního souboru a tyto jednotlivé snímky následně spojit do finálního videa pomocí nástroje jako FFmpeg. 

\textcolor{red}{LERP, co jak kdy proč}

\textcolor{red}{Definovat funkci lerp()}

Tyto snímky musí být umístěné na linii mezi počátečním ($a$) a koncovým ($b$) bodem přechodu. 
\[c = (1-t)*a + t * b\] 
Kde $t$ představuje parametr v intervalu $\langle0;1\rangle$, který plynule přechází mezi hodnotami $0$ a $1$. Výsledkem této rovnice je hodnota $c$, která reprezentuje hodnotu mezi počátečním a koncovým bodem v závislosti na parametru $t$. Tento přechod je těžko vizualizovatelný v papírové podobě a je tedy dostupný na \url{https://c.itoncek.space/maturitni_prace/lerp_1}.

Z demonstrace je zřejmá hlavní nevýhoda tohoto přístupu. Animace je sice plynulá, ale začátky a konce jsou trhané. Ve finálních animacích tedy používám ještě jeden mezikrok, který nám pomůže vytvořit plynulý začátek i konec přechodu.

vyřešit

Pro dosažení požadované plynulosti využívám metodu \textit{easeInOutQuad()}, která vstupní hodnotu $t$ přetranformuje na kubickou rovnici, jejíž rychlost (první derivace) představuje perfektní parabolu.

Průběh a plynulost lineárního a kvadratického přechodu je porovnána na grafech~\ref{graph:lerp_linear} a~\ref{graph:lerp_quadr}; vizuální reprezentace je dostupná na \url{https://c.itoncek.space/maturitni_prace/lerp_2}.

Častými náhradami kvadratického přechodu jsou kubické a kvartické ekvivalenty, které začínají sice plynuleji, ale během cesty naberou výrazně vyšší rychlost, která může být potenciálně nepříjemná pro diváky. Další nevýhodou je relativní složitost vyjádření kubického a kvartického přechodu pomocí jednotlivé funkce. Tyto přechody jsou často simulovány spojením dvou kubických nebo kvartických funkcí v $t=\frac{1}{2}$.

\textcolor{red}{Kam zmizela sekce?}

Nástroj StellariumPanoramaCreator, který jsem pro tento úkol vytvořil, plní úlohu generátoru skriptů. Ve skriptu je předem definováno, jaké kroky má Stellarium provést. Je volně dostupný na adrese \url{https://github.com/IToncek/StellariumPanoramaCreator}. Při svém běhu postupně prochází skrze předprogramované instrukce, které jsou zabudované přímo ve zdrojovém kódu a generuje podle nich řádky skriptu a případné složky, potřebné pro úspěšný běh skriptu. Mezi funkcemi, které často využívám se nachází například funkce \textit{setup()}. Připraví Stellarium pro zaznamenávání videa (vypne veškerá překrytí, změní model atmosféry, skryje objekty Sluneční soustavy, \ldots). Funkce \textit{move()}, která otočí kameru na pozici dodanou v parametru \textit{orientation}, nastaví datum a čas dodaný v parametru \textit{datetime}. Další využívanou funkcí je \textit{cheese()}, která pořídí snímek v aktuální orientaci a uloží ho ve formátu TIFF. % chktex 36

Z těchto základních \enquote{stavebních} funkcí jsou poté sestavovány funkce komplexnějšího rázu, jako například funkce \textit{slideTo()}. Tato funkce vytváří primitivním způsobem skriptové soubory tak, že pro každý snímek definuje otočení pohledu, změnu času a dne, změnu přiblížení a uloží výsledný pohled do souboru. 

Během přípravy této maturitní práce do sady funkcí přibyla nová kategorie funkcí, které nechávají veškeré výše uvedené výpočty na Stellariu. Tato nová metoda umožňuje využití automatického výpočtu trajektorie za běhu skriptu místo generování jednotlivých bodů trajektorie předem. 

Jednou z dalších nových funkcí je \textit{travelTrack()}, která vytvoří plynulý přechod mezi nebeskými souřadnicemi dvou objektů bez nutnosti zadávání jejich souřadnic do logiky skriptu. Další novou funkcí je \textit{slideTrack()}, která sleduje jeden vybraný objekt a zajistí, že je na každém snímku přesně uprostřed. % chktex 36

Pro ukládání takto vygenerovaných snímků využívám formát TIFF, který mi poskytuje vysoce kvalitní data, komprimována bezztrátově pomocí algoritmu LZW.\@ Jeden takový snímek má rozlišení \(3840\times2160\) pixelů a velikost 5-7MB. Dohromady má jeden přechod mezi scénami velikost přibližně 7GB.\@ Pro celé video by to znamenalo velikost přes 200GB. Aktuálně nevlastním žádný disk s dostatečnou kapacitou a rychlostí pro střih. Proto v posledním kroku příprav převedu každý přechod do formátu ProRes, který mi umožňuje snížit velikost na pouhých 10GB, za cenu minimální ztráty na kvalitě. 

Při kompilaci jednotlivých snímků do videí nastavuji finální snímkovací frekvenci projektu, jíž je pro AstroCrew 50 sn./s. Tato snímkovací frekvence je v souladu se standardem \textcolor{red}{check} EBU a příjemná pro oko diváka.

Pro video o \enquote{Úkazech na obloze v roce 2025} jsem zvolil trochu jiný postup. Přechody ukládám ve formátu JPEG2000, který používá ztrátovou kompresi. Celé video je tak možné na konci procesu vyrendrovat znova a opravit případné drobné detaily, které ve videu mohly vziknout v průběhu jeho tvorby.\fcite{jpeg2000}
\subsection{Kompletace videa v programu DaVinci Resolve}\label{makingof:resolve}
\subsubsection{Spojování jednotlivých částí}\label{makingof:resolve:merging}
Poté co je nahrán zvuk a vytvořeny veškeré animace následuje finální kompletace všech složek do finálního videa. Zde se poprvé potkává hlasová a obrazová složka. Na začátku každého videa máme několik videí, zatím co uvádíme obsah videa. Tato videa jsou s vesmírnou tématikou a častým kandidátem jsou záběry z mezinárodní vesmírné stanice, jelikož podléhají minimálním autorským právům. Po úvodním slovu a upozornění ohledně pravdivosti informací ve videu v závislosti na pozici pozorovatele na zemi přijde hlavní část videa. Zde se začínají přes sebe překrývat soubory vytvořené v sekci~\ref{makingof:stellarium}.

První scéna začíná bez jakýchkoliv souhvězdích viditelných a postupně jak video pokračuje, objevují se postupně další souhvězdí. Následující scény se drží velice podobné struktury, která je vidět na obrázku~\ref{img:timeline}. Na začátku, a ve speciálních případech i uprostřed scény, se vyskytují animace, které jsou na snímku označeny číslem 1. V průběhu scény je jako podklad využit statický snímek, vygenerovaný v sekci~\ref{makingof:stellarium}. Tento snímek je označený číslem 2 a slouží jako základ každé scény, přes který jsou poté překryty snímky souhvěždí (3) a objektů hlubokého vesmíru (5). Pro větší názornost využíváme tzv.\ pointer (4), animovaný klip pulzijícího čtverce se zaoblenými rohy, jež zvýrazňuje část obrazu o kterém právě pojednává scénář, jehož vizuální reprezentace je vidět jako obrázek~\ref{img:pointer}. Někdy je třeba zvýraznit zvolený objekt hlubokého vesmíru na úkor pozadí, které zrovna v daném momentě není důležité. V tomto snímku je tento tzv. Adjustment Clip vidět pod číslem 6. Zvuková část se po většinu času skládá ze dvou stop: hlasové stopy (7) a hudební stopy (8). Hlasová stopa se nachází primárně mimo animace, kdy její dominantní místo nahradí hudba, která je po dobu přechodů zesílena.

Nad scénou se nachází pět až šest stop s titulky. Tyto stopy využíváme nejen pro standardní využití ve formě titulků v Češtině a někdy i v Angličtině, ale využíváme je i jako prostor pro citování zdrojů obrazových materiálů, opravě chyb v již vydaném videu, poznámky a doplnění obsahu od editora a stopa s informacemi a zdrojích hudby. Tento postup využíváme hlavně kvůli jednoduchosti tvorby titulků a možnosti tyto titulky skrýt a nebýt jimi rušen. 

Souhvězdí a objekty hlubokého vesmíru jsou řazeny podle nejlepšího času pozorování od západu slunce k východu slunce. Poté nastává část, kde zmíníme nejdůležitější události, které v průběhu měsíce nastávají. Na tomto místě zmiňujeme meteorické roje a atmosférické i vesmírné úkazy, které se mohou v průběhu měsíce ukázat.
\subsubsection{Mixování obrazové části}
Záběry jsou vrstveny přes sebe pomocí metody Lighten. Tato metoda pro každý pixel vypočítá barvu podle rovnice $[\max(r_1, r_2), \max(g_1, g_2), \max(b_1, b_2)]$,\fcite{wiki:blend} kde tato množina představuje červený, zelený a modrý kanál v tomto pořadí. Toto umožňuje světlým obrázkům souhvězdí překrývat se, aniž by bylo třeba odstraňovat u každého pozadí. Tento způsob mixování také využívám pro fotografie objektů hlubokého vesmíru. 

Nejdříve získám obrázek daného objektu z internetu. Nejčastějším zdrojem je Wikipedie, která poskytuje jasné licenční podmínky. Pokud na Wikipedie nemá vhodný nebo dostatečně kvalitní obrázek, začnu hledat po internetu další fotografie. Občas ani tento krok nepomůže, zvláště u objektů nezajímavých pro focení. V tomto případě se otočím na celooblohové sady dat, například Digitized Sky Survey 2 nebo Mellinger color optical survey které získávám z Centra astronomických dat univerzity ve Štrasburku díky jejich nástroji Aladin. Tyto sady dat pokrývají značný zlomek celé oblohy a z geografické pozice České republiky pokrývají 100\% viditelné oblohy. Tyto fotografie následně upravuji pomocí software Zoner Photo Studio X, kde upravím kontrast pozadí tak, aby bylo absolutně černé a tudíž při kompletaci zmizelo. Následně odstraním hvězdy blízko okraje snímku, aby byl přechod mezi snímkem a pozadím méně znatelný. Tyto fotografie jsou následně překrývány přes souhvězdí a pozadí. 
\subsection{Mixování zvukové části}
Ve zvukové části jsou na sebe navrstveny stopy hudby a hlasu. Hudbu jsem vlastnoručně vybíral ze seznamu hudby v knihovně YouTube a ze seznamu skladeb, využívaných softwarem SpaceEngine. Základním kritériem je, aby hudba nijak diváka nerušila ale zároveň pomáhala s atmosférou celého videa. Jako úvodní hudbu v našich videích používáme stopu \textit{Beyond --- Patrick Patrikios} ze zvukové knihovny YouTube. V hlavní části se objevují stopy z software SpaceEngine, jako například \textit{Space G Lydian --- Alfred Potter}, \textit{The Blithering Heights --- Akira} a \textit{A peaceful Place --- Goodstreet}. Jako naší koncovou hudbu využíváme stopu \textit{Instant Crush --- Corbyn Kites} znovu ze Zvukové knihovny YouTube.
\section{Historie popularizace astronomie (WIP)}

\section{Historie a vývoj procesu tvorby astronomických videí}
Proces tvorby našich astronomických videí se v průběhu let výrazně změnil. První video jsme vytvořili v roce 2021 a od té doby jich vzniklo dalších 10\footnote{Započítávám zatím nevydaná videa, která budou vydaná do data maturitních zkoušek}.V této části se podíváme na celou historii tvorby astronomických videí skupinou AstroCrew.
\subsection{Začátky --- Prosinec 2021}
Naše cesta začala v prosinci roku 2021. Zde jsme 14.\ prosince vydali naše první video. Toto video nebylo primárně určené k vydání na platformě YouTube ale bylo připraveno pro planetárium v iQLandii, kde jsme ho představili již 9.\ prosince. Celé video je kvůli tomu promítnuto sféricky, jak můžete vidět na obrázku~ref{img:prosinec}. Pro YouTube jsme toto video modifikovali, aby ho YouTube vzal jako 360° video, i když polovina videa je čistě černá. Co se týče produkce, toto video bylo velice náročné. Stříhací program, kterým byl v té době ještě Adobe Premiere Pro, neustále padal, a obecně tvorba animací v té době probíhala ještě manuálně. Stellárium dává k dispozici webové rozhraní umožňující plnou kontrolu nad danou instancí Stellária. 

Toto video jsem natáčel tak, že jsem namířil Stellarium podobně, jako je namířená kopule planetária v iQLandii a poté jsem pomocí přesouvání času přemisťoval souhvězdí a jednotlivé objekty tak, aby byly co nejlépe vidět. Následně jsem pomocí programu Adobe After Effects vložil do scény obrázky daných objektů hlubokého vesmíru pomocí integrovaného efektu VR Converter. Díky technologii Adobe Dynamic Link jsem poté jen vložil kompozice z After Effects přímo do časové osy v Premiere Pro a nemusel jsem je exportovat. Bohužel tento přístup je neskutečně pomalý a snižuje významně výkonnost celého stříhacího programu. Z tohoto důvodu je Prosinec 2021 jediným videem vytvořeným v tomto stylu.
\subsection{Jednoduchá éra --- Březen až Květen 2022}
Celý proces, jak jsem ho popsal v sekci~\ref{makingof} je aktuálním stavem tvorby. Na úplném začátku produkce tento proces ještě neexistoval a veškeré znalosti potřebné pro tvorbu \textquote{moderních} videí bylo nutné získat postupným experimentováním. Videa v této éře byla velice jednoduchá. Animace byly vytvořeny nahráváním okna Stellaria a jeho ovládáním přes webové rozhraní. 

Ačkoliv tento proces byl jednoduchý na provedení, byl náročný na čas. Pokud jsem vybral špatný objekt, musel jsem se vrátit na předchozí a nahrát celý přechod znovu. Pokud se Stellarium trochu zaseklo někde uprostřed přechodu, musel jsem daný přechod nahrát znovu. Tyto situace se mohou zdát nedůležité, ale při množství přechodů, které v té době ve videích byly, se tyto časové ztráty jednoduše nasčítaly a zpomalily celou produkci videa. Ukázku finálního videa jsem připojil v přílohách jako obrázek~\ref{img:brezen}.

Do této kategorie se připletlo ještě video s názvem \textquote{Jak pozorovat zatmění Měsíce 16.5.2022}, které jsme vydali 13. 5. 2022. Toto video je přechodem k další éře, primárně z důvodu, že neobsahuje ani jeden záběr ze Stellaria. Toto video se skládá primárně ze záběrů zatmění měsíce a animace vygenerované pomocí systému Space Engine. Ačkoliv toto video má největší počet shlédnutí na našem YouTube kanálu, má relativně nízký dopad na náš YouTube kanál, jelikož většina těchto shlédnutí je ze stránek astro.cz a seznamzpravy.cz, na které toto video nasdílel Martin Gembec, vedoucí planetária v iQLandii.
\subsection{Éra spěchu --- Červen a Červenec 2022}
Červnové a červencové Astronomické Desetiminutovky byly stříhány ve velikém spěchu. S příchodem prázdnin se množství volného času, který jsem měl k dispozici na stříhání se snížilo a tudíž bylo třeba produkci optimalizovat. V této době jsem také začal přecházet do nového stříhacího programu, zvaného DaVinci Resolve, který využívám doteď. Tato změna prostředí produkce znamenala, že videa musela být jednodušší na produkci a tudíž kvalita lehce upadla. Ukázku finálního videa jsem připojil v přílohách jako obrázek~\ref{img:cervenec}.

Tato videa jsou jednoduchá, složená z časosběrných záběrů se zvukovým komentářem a občasnými grafikami, vytvořenými ručně ve Stellariu. Tato videa jsou opravdu základní a rád bych je v budoucnu znovu navštívil a pokusil se je předělat na moderní formát. Nicméně tato videa sloužila jako můstek k modernímu procesu tvorby videí, který se poprvé projevil v Únorových Astronomických desetiminutovkách.
\subsection{Renezance Astrocrew --- Únor 2023}
První video, které se dá kategorizovat pod skupinu moderních AstroCrew videí. V této době jsem poprvé začal pracovat se Stellariem jako s nástrojem pro generování dat, která jsou později upravena do finální podoby místo jeho využívání jako zdroj videa. 

Základní metodika byla jednoduchá, nafotit celooblohovou panorámu oblohy, složit jí do jednoho snímku a ten poté otáčet ve stříhacím programu. V této době začal vznikat nástroj StellariumPanoramaCreator (dále jen jako SPC), který se již v produkci udržel. První verze SPC byla velice jednoduchá. Skript převzal kontrolu nad klávesnicí a myší mého počítače a pomocí integrovaného okna přímo ve Stellariu, které umožňovalo zadat azimut a výšku, postupně nafotilo všech 54 panelů, ze kterých se poté finální panoráma složila za pomoci programu Hugin, který dostal všechny panely a projektový soubor, který byl vygenerován při běhu SPC.\@ Následně Hugin převedl tyto panely do kompletní panorámy.

Zpracování těchto dat bylo mnohem komfortnější než skládání videí natočených manuálně ale pořád vyžadovalo mnoho práce, než byla data získána a tento čas nebylo možné nijak jinak využít. Během získávání dat nebylo možné využívat ani klávesnici ani myš. Nebylo možné ani odkliknout z okna, jelikož pro ovládání Stellaria bylo třeba, aby Stellarium zachytávalo klávesnici i myš. Proto dalším logickým krokem bylo převedení komunikace za oponu. 

Ideálním řešením se ukázalo být webové rozhraní Stellaria. Tento modul je určen pro řízení Stellaria z tabletu nebo jiného počítače v případě, že není možné ovládat počítač se Stellariem. Na pozadí tento systém využívá architektury HTTP, která umožňuje přistupovat k specifickým částem kódu Stellaria přes lokální síť. Tento modul byl vyvinut jako projekt v rámci akce \textquote{ESA Summer of Code 2015}\fcite{stellarium:rcDoc}. 

Dokumentace\fcite{stellarium:rcAPI} tohoto protokolu je bohužel v některých místech relativně chaotická a nečitelná. Pro vývoj jsem tedy použil existující HTML rozhraní a pomocí vývojářských nástrojů, dostupných ve většině moderních prohlížečů, jsem postupně zjistil veškeré adresy a parametry, které mám Stellariu posílat, aby dělalo to, co má. Poté jsem SPC přepsal, aby místo ovládání klávesnice a myši využívalo nově dostupné HTTP dotazy. Po náročné optimalizaci načasování jednotlivých příkazů se časová náročnost snížila přibližně na polovinu předchozího času a celý proces mohl nyní proběhnout na pozadí. Ukázku finálního videa jsem připojil v přílohách jako obrázek~\ref{img:unor}.

V této fázi střih probíhal zpět v Adobe Premiere Pro, primárně kvůli pluginu Gopro FX Reframe, který panorámu, kterou jsem vygeneroval v předchozím kroku, převedl na perspektivní zobrazení. Tento systém měl mnoho výhod oproti předchozímu procesu, při kterém bylo nutné perfektně trefit načasování při natáčení a když se něco nepodařilo, bylo nutné celý segment natočit znovu. V této verzi procesu stačilo přeanimovat poslední přechod a upravit časování sekvence a problém byl vyřešen. I tak, tento postup nesl značné nevýhody. Hlavní z nich byla neskutečná zátěž systému, z části podpořena i přirozená zátěž samotného Premiere. Tento fakt znamenal, že export Únorových Astronomických Desetiminutovek zabral 90 minut na 12 minut videa. V říjnu 2023 se navíc tento plugin kompletně rozpadl a úplně přestal fungovat, což prakticky zrušilo Říjnové Astronomické Desetiminutovky. Proto pro následující projekt bylo nutné vyvinout nový proces. 
\subsection{Moderní Astrocrew --- Rok 2024, Prosinec 2024 a Rok 2025}
V listopadu roku 2023 přinesl Dan do naší skupiny nápad, udělat video, shrnující úkazy, které budou vidět v následujícím roce na obloze. Po nedávném neúspěchu ve tvorbě Říjnových Astronomických Desetiminutovek bylo nutné změnit celý proces. Prvním pokusem bylo využití animačního programu Blender a zachování exportu panorám a jejich pozdější přemapování do perspektivního zobrazení. Tento postup sice fungoval, ale při tvorbě jsem byl nucen každé video exportovat \(2\times \), jednou jako panorámu a jednou jako animovaný přechod. Během pokusů s touto metodou mě ale napadla revoluční myšlenka. Místo exportu celé panorámy, ze které jsem pokaždé minimálně polovinu zahodil, exportovat pouze potřebnou oblast pro finální video. 

V této epoše se StellariumPanoramaCreator (dále jen SPC) přetvořil do téměř finální podoby. Jako vstup sloužily souřadnice a časy jednotlivých zastávek a SPC následně ovládal Stellarium pomocí HTTP, jako v předchozí edici. Výstupem bylo 500 snímků pro každý přechod v rozlišení \(3840\times2160\) pro složení do finálního videa. Ačkoliv tento postup byl výrazně rychlejší a příjemnější než postupy předchozí, odhalil také několik slabých stránek implementace webového rozhraní Stellaria. Stellarium je schopné z webu zpracovávat příkazy pouze sekvenčně, tudíž není možné odeslat všechny příkazy naráz a jen počkat, než se Stellarium vzpamatuje, místo toho je nutné načasovat každý příkaz tak, aby strávil ve frontě minimum času.

Tímto způsobem bylo vytvořeno video \textquote{Co nás čeká na obloze v roce 2024?}. Pro videa \textquote{Astronomické desetiminutovky --- Prosinec} a \textquote{Co nás čeká na obloze v roce 2025?} byla provedena malá změna, kdy se příkazy přestaly odesílat přes HTTP ale byly zapsány do skriptového souboru Stellaria, které následně tyto příkazy spustilo v maximální dostupné rychlosti.
\newpage
\part{Praktická část}
\textcolor{red}{Projekt Rok 2025 pro praktickou část maturitní práce je nyní v závěrečném stádiu produkce a není možné ho zatím do této verze přidat.}
\newpage
\part{Přílohy}
\begin{figure}[ht]
	\centering
	\includegraphics[width=1\textwidth]{fourier.png}
	\caption{Porovnání šumové stopy projektu Rok 2025 (vlevo, využit \enquote{peřinový bunkr} pro snížení hladiny šumu) a projektu Prosinec (vpravo). Vysvětleno v oddílu~\ref{makingof:text-audio-prep}}\label{img:fourier}
\end{figure}
\begin{table}[h]
	\centering
	\begin{tabularx}{\linewidth}{lc*{5}{>{\RaggedRight\arraybackslash}X}}
	\toprule
	\# scény    & Směr scény & Čas          & Souhvězdí         & Speciální objekty      \\ \midrule
	0000        & Z obzor    & západ slunce & Labuť, Lyra, Orel & Letní trojúhelník      \\ \addlinespace
	0001        & SZ obzor   & západ slunce & dtto, Herkules    & Herkulův květináč, M13 \\ \addlinespace
	0002        & Z obzor    & západ slunce & dtto              & ---                    \\ \addlinespace
	\ldots      & \ldots     & \ldots       & \ldots            & \ldots                 \\ \bottomrule
	\end{tabularx}
	\caption{Demonstrace tabulky s informacemi o scénách}\label{tab:scenar}
\end{table}		
\begin{figure}[ht]
	\centering
	\includegraphics[width=1\textwidth]{timeline_annotated.eps}
	\caption{Snímek jedné ze scén z finálního videa. Každá důležitá stopa má přiřazené číslo. Vysvětleno v oddílu~\ref{makingof:resolve:merging}}\label{img:timeline}
\end{figure}

\begin{figure}[ht]
	\centering
	\includegraphics[width=.5\textwidth]{pointer.eps}
	\caption{Animace zvaná pointer, využívaná pro upřesnění pozice objektu, o kterém v daném momentě mluví scénář.}\label{img:pointer}
\end{figure}

\begin{figure}[ht]
	\centering
	\includegraphics[width=.7\textwidth]{prosinec.eps}
	\caption{Demonstrace našeho prvního videa.}\label{img:prosinec}
\end{figure}

\begin{figure}[ht]
	\centering
	\includegraphics[width=.85\textwidth]{brezen.png}
	\caption{Demonstrace našeho prvního videa.}\label{img:brezen}
\end{figure}


\begin{figure}[ht]
	\centering
	\includegraphics[width=.85\textwidth]{cervenec.png}
	\caption{Demonstrace našeho prvního videa.}\label{img:cervenec}
\end{figure}

\begin{figure}[ht]
	\centering
	\includegraphics[width=.85\textwidth]{unor.png}
	\caption{Demonstrace našeho prvního videa.}\label{img:unor}
\end{figure}

\begin{figure}[ht]
	\begin{subfigure}{0.43\textwidth}
		\begin{tikzpicture}[scale=0.75]
			\begin{axis}
			[
			    xlabel={$t$}, 
			    ylabel={$x$}, 
			    xmin=0, 
			    xmax=1, 
			    ymin=0, 
			    ymax=1, 
			    axis lines=left
			]
				\addplot[no marks, solid, domain=0:1, samples=50] {x};
			\end{axis}
		\end{tikzpicture}
		\caption{Závislost $x$ na $t$ pro základní lineární interpolaci}
	\end{subfigure}\hfill
	\begin{subfigure}{0.44\textwidth}
		\begin{tikzpicture}[scale=0.75]
			\begin{axis}
			[
			    xlabel={$t$}, 
			    ylabel={$\frac{dx}{dt}$}, 
			    xmin=0, 
			    xmax=1, 
			    ymin=0.8, 
			    ymax=1.2, 
			    axis lines=left
			]
				\addplot[no marks, solid, domain=0:1, samples=50] {1};
			\end{axis}
		\end{tikzpicture}
		\caption{$\frac{dx}{dt}$ pro základní lineární interpolaci}
	\end{subfigure}
	\captionsetup{name=Graf}
	\caption{Graf znázorňující hodnotu a rychlost změny výstupu implementace lineární interpolace s kvadratickým přechodem}\label{graph:lerp_linear}
\end{figure}

\begin{figure}[ht]
	\begin{subfigure}{0.43\textwidth}
		\begin{tikzpicture}[scale=0.75]
			\begin{axis}
			[
			    xlabel={$t$}, 
			    ylabel={$x$}, 
			    xmin=0, 
			    xmax=1, 
			    ymin=0, 
			    ymax=1, 
			    axis lines=left
			]
				\addplot[no marks, solid, domain=0:1, samples=50] {3*pow(x,2) - 2*pow(x,3)};
			\end{axis}
		\end{tikzpicture}
		\caption{Závislost $x$ na $t$ pro základní lineární interpolaci}
	\end{subfigure}\hfill
	\begin{subfigure}{0.44\textwidth}
		\begin{tikzpicture}[scale=0.75]
			\begin{axis}
			[
			    xlabel={$t$}, 
			    ylabel={$\frac{dx}{dt}$}, 
			    xmin=0, 
			    xmax=1, 
			    ymin=0, 
			    ymax=1.8, 
			    axis lines=left
			]
				\addplot[no marks, solid, domain=0:1, samples=50] {6*x - 6*pow(x,2)};
			\end{axis}
		\end{tikzpicture}
		\caption{$\frac{dx}{dt}$ pro základní lineární interpolaci}
	\end{subfigure}
	\captionsetup{name=Graf}
	\caption{Graf znázorňující hodnotu a rychlost změny výstupu implementace lineární interpolace s kvadratickým přechodem}\label{graph:lerp_quadr}
\end{figure}
\end{document}
